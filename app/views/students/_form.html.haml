= form_for student, url: student_path(student), id: 'student_form' do |f|
  .row
    .large-field
      %label foto
      %input{ type: 'text', name: '' }
      %button.button.primary{ type: 'submit' }
        <i class='icon-file'></i> selecionar arquivo

  .row
    .field
      = f.label :name, class: 'required'
      = f.text_field :name, required: true

    .field
      = f.label :email, class: 'required'
      = f.email_field :email, required: true, email: true

  .row
    .field
      = f.label :enrollment, class: 'required'
      = f.text_field :enrollment, required: true

    .field
      = f.label :birth_date
      = f.text_field :birth_date, data: { inputmask: "'alias': 'date'" }

  - if student.new_record?
    .row
      .field
        = f.label :password, class: 'required'
        = f.password_field :password, required: true

      .field
        = f.label :password_confirmation, class: 'required'
        = f.password_field :password_confirmation, required: true, equalto: '#user_password'
  - else
    .row
      .field
        = f.label :password, "Senha <i class='icon-lock'></i>".html_safe
        = f.password_field :password, required: true, disabled: true, placeholder: '********'

      .field
        = f.label :password_confirmation, "Confirmação da senha <i class='icon-lock'></i>".html_safe
        = f.password_field :password_confirmation, required: true, equalto: '#user_password', disabled: true, placeholder: '********'

  .divider

  .row
    .field
      = f.label :cellphone_number
      = f.text_field :cellphone_number, data: { inputmask: "'alias': 'cellphone'" }

    .field
      = f.label :phone_number
      = f.text_field :phone_number, data: { inputmask: "'alias': 'phone'" }

  .row
    .field
      = f.label :address
      = f.text_field :address

    .small-field
      = f.label :address_number
      = f.text_field :address_number, data: { inputmask: "'alias': 'integer', 'rightAlignNumerics': false"}

    .small-field
      = f.label :address_complement
      = f.text_field :address_complement

  .row
    .field
      = f.label :address_state
      = f.select :address_state, City.order(:uf).select(:uf).uniq.collect { |city| [city.uf,city.uf] }, include_blank: 'Selecione'

    .field
      = f.label :address_city
      = f.select :address_city, City.select(:name).find_by_uf(student.address_state).collect { |city| [city.name, city.name] }, include_blank: 'Selecione'

  .clear
  %button.button.primary{ type: 'submit', name: 'commit' }
    <i class='icon-ok'></i> Confirmar

= content_for :javascript do
  :javascript
    $(document).ready(function() {
      $('.new-box form').validate();

      $('#user_address_state').change(function(){
        $.ajax({
          type: 'GET',
          url: '/get_cities_by_uf/'+$(this).val(),
          success: function(data) {
            element = $('#user_address_city');
            element.html('');
            element.append("<option value=''>Selecione</option>")
            for (var i = 0; i < data.length; i++) {
              element.append("<option value='"+data[i].name+"'>"+data[i].name+"</option>");
            }
          }
        });
      });

      $('form').on('click', '.icon-lock', function() {
        unlock();
      });

      $('form').on('click', '.icon-unlock', function() {
        lock();
      });

      function lock(icon) {
        $('.icon-unlock').removeClass('icon-unlock').addClass('icon-lock');

        $('#user_password').val('').prop('disabled', true);
        $('#user_password_confirmation').val('').prop('disabled', true);
      }

      function unlock(icon) {
        $('.icon-lock').removeClass('icon-lock').addClass('icon-unlock');

        $('#user_password').prop('disabled', false);
        $('#user_password_confirmation').prop('disabled', false);
      }
    });
